python train_fsl.py --max_epoch 200 --model_class ProtoNet --backbone_class Res12 --dataset MiniImageNet --way 5 --eval_way 5 --shot 5 --eval_shot 5 --query 15 --eval_query 15 --balance 0.01 --temperature 64 --temperature2 64 --lr 0.0002 --lr_mul 10 --lr_scheduler step --step_size 40 --gamma 0.5 --gpu 0 --init_weights ./saves/initialization/miniimagenet/protonet-5-shot.pth --eval_interval 1 --use_euclidean

### 2

python train_fsl.py --max_epoch 200 --model_class ProtoNet --backbone_class Res12 --dataset MiniImageNet --way 5 --eval_way 5 --shot 5 --eval_shot 5 --query 15 --eval_query 15 --balance 0.01 --temperature 64 --temperature2 32 --lr 0.001 --lr_mul 10 --lr_scheduler step --step_size 10 --gamma 0.2 --gpu 0 --init_weights ./saves/initialization/miniimagenet/protonet-5-shot.pth --eval_interval 1 --use_euclidean

### 3

python train_fsl.py --max_epoch 200 --model_class ProtoNet --backbone_class Res12 --dataset MiniImageNet --way 5 --eval_way 5 --shot 5 --eval_shot 5 --query 15 --eval_query 15 --balance 0.01 --temperature 64 --temperature2 32 --lr 0.0005 --lr_mul 40 --lr_scheduler step --step_size 20 --gamma 0.2 --gpu 0 --init_weights ./saves/initialization/miniimagenet/protonet-5-shot.pth --eval_interval 1 --use_euclidean

### 4

python train_fsl.py --max_epoch 200 --model_class ProtoNet --backbone_class Res12 --dataset MiniImageNet --way 5 --eval_way 5 --shot 5 --eval_shot 5 --query 15 --eval_query 15 --balance 0.01 --temperature 64 --temperature2 16 --lr 0.0005 --lr_mul 40 --lr_scheduler step --step_size 20 --gamma 0.5 --gpu 0 --init_weights ./saves/initialization/miniimagenet/protonet-5-shot.pth --eval_interval 1 --use_euclidean 

### 5

python train_fsl.py --max_epoch 200 --model_class ProtoNet --backbone_class Res12 --dataset MiniImageNet --way 5 --eval_way 5 --shot 5 --eval_shot 5 --query 15 --eval_query 15 --balance 0.01 --temperature 64 --temperature2 16 --lr 0.0005 --lr_mul 40 --lr_scheduler step --step_size 20 --gamma 0.5 --gpu 0 --init_weights ./saves/initialization/miniimagenet/protonet-5-shot.pth --eval_interval 1 --use_euclidean --augment --seed 3407


| 参数           | 说明                                                                                           |
| -------------- | ---------------------------------------------------------------------------------------------- |
| `dataset`    | 使用的数据集，可选 `MiniImageNet`、`TieredImageNet`或 `CUB`，默认值为 `MiniImageNet`。 |
| `way`        | meta-training 阶段的每个 few-shot 任务中包含的类别数量（即 N-way），默认 `5`。               |
| `eval_way`   | meta-test 阶段的每个 few-shot 任务中包含的类别数量，默认 `5`。                               |
| `shot`       | meta-training 阶段每个类别中的样本数量（即 K-shot），默认 `1`。                              |
| `eval_shot`  | meta-test 阶段每个类别中的样本数量，默认 `1`。                                               |
| `query`      | meta-training 阶段每个类别用于评估性能的查询样本数，默认 `15`。                              |
| `eval_query` | meta-test 阶段每个类别用于评估性能的查询样本数，默认 `15`。                                  |

| 参数                   | 说明                                                                                                           |
| ---------------------- | -------------------------------------------------------------------------------------------------------------- |
| `max_epoch`          | 最大训练轮数（epochs），默认 `200`。                                                                         |
| `episodes_per_epoch` | 每个 epoch 中采样的任务数量，默认 `100`。                                                                    |
| `num_eval_episodes`  | 从验证集（meta-val）中采样的任务数量，用于评估模型性能（最终评估时会固定采样 10,000 个任务），默认 `200`。   |
| `lr`                 | 模型的学习率，若使用预训练权重，默认 `0.0001`。                                                              |
| `lr_mul`             | 专为集合到集合（set-to-set）方法（如 FEAT）设计，用于放大顶层的学习率，默认 `10`。                           |
| `lr_scheduler`       | 学习率调度策略，可选 `step`、`multistep`或 `cosine`，默认 `step`。                                     |
| `step_size`          | 若使用 `step`调度器，则是学习率下降的间隔；若使用 `multistep`，可提供多个值。默认 `20`。                 |
| `gamma`              | 学习率衰减系数，用于 `step`或 `multistep`调度，默认 `0.2`。                                              |
| `fix_BN`             | 在 meta-training 阶段将编码器（backbone）设置为评估模式，用于固定 BatchNorm（在 WRN 中常用）。默认 `False`。 |
| `augment`            | 是否在 meta-training 阶段进行数据增强，默认 `False`。                                                        |
| `mom`                | SGD 优化器的动量（momentum）值，默认 `0.9`。                                                                 |
| `weight_decay`       | SGD 优化器的权重衰减值，默认 `0.0005`。                                                                      |

| 参数               | 说明                                                                                                                                                                                                 |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `model_class`    | meta-learning 使用的模型类型。支持：• 基线模型：`MatchNet`,`ProtoNet`• 集合到集合函数：`BILSTM`,`DeepSet`,`GCN`,`FEAT`等• 半监督版本：`SemiFEAT`,`SemiProtoFEAT`。默认 `FEAT`。 |
| `use_euclidean`  | 是否使用欧式距离（euclidean distance）来计算类别间距离。如果不启用，则使用余弦相似度（cosine similarity）。论文中默认使用欧式距离。默认 `False`。                                                  |
| `backbone_class` | 特征提取器（编码器）的类型，可选：`ConvNet`,`Res12`,`WRN`，默认 `ConvNet`。                                                                                                                  |
| `balance`        | 对比正则化项（contrastive regularizer）的平衡权重，默认 `0`。                                                                                                                                      |
| `temperature`    | logits 的温度系数，会将 logits**除以**该值，用于平滑模型输出。常用于带预训练权重的情形。默认 `1`。                                                                                           |
| `temperature2`   | 对比正则项中的温度系数，同样会将 logits 除以该值，专门为 contrastive regularizer 设计。默认 `1`。                                                                                                  |

| 参数              | 说明                                                                                      |
| ----------------- | ----------------------------------------------------------------------------------------- |
| `orig_imsize`   | 是否在加载数据前调整图片尺寸。`-1`表示不调整尺寸且不预加载所有图片到内存。默认 `-1`。 |
| `multi_gpu`     | 是否使用多 GPU 训练，默认 `False`。                                                     |
| `gpu`           | 指定使用的 GPU 索引；若启用多 GPU，可提供多个索引。默认 `0`。                           |
| `log_interval`  | 每隔多少个任务记录一次 meta-training 日志，默认 `50`。                                  |
| `eval_interval` | 每隔多少个 epoch 进行一次验证（meta-val），默认 `1`。                                   |
| `save_dir`      | 保存训练模型的路径，默认 `./checkpoints`。                                              |
